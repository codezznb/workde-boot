{"hidden":false,"children":[{"configs":{"itemId":"module"},"expanded":true,"children":[{"configs":{"layout":"fit","itemId":"viewport1"},"expanded":true,"children":[{"configs":{"itemId":"grid1","title":"用户管理","iconCls":"user_icon","multiSelect":"true"},"expanded":true,"children":[{"configs":{"itemId":"tbar"},"expanded":true,"children":[{"configs":{"itemId":"item1","text":"新增","iconCls":"record_add_icon"},"expanded":false,"children":[],"type":"item","events":{"click":"app.isNew = true;\napp.winUser.show();"}},{"configs":{"itemId":"item2","text":"修改","iconCls":"record_edit_icon"},"expanded":false,"children":[],"type":"item","events":{"click":"var record = app.grid1.getSelection();\nif(record.length === 0){\n  Wb.warn(\"请选择一条需要修改的记录\");\n  return;\n}\napp.selRec = record[0];\napp.winUser.show();\napp.winUser.setTitle(\"修改 - \" + app.selRec.data.phone);\nWb.setValue(app.winUser, app.selRec.data);\napp.isNew = false;"}},{"configs":{"itemId":"item3","text":"删除","iconCls":"record_delete_icon"},"expanded":false,"children":[],"type":"item","events":{"click":"var sels = app.grid1.getSelection();\nWb.confirmDo(sels, function() {\n  Wb.request({\n    url: 'builder?xwl=user/crud/delete',\n    params: {\n      destroy: Wb.getData(sels, true)\n    },\n    success: function() {\n      Wb.remove(app.grid1, sels);\n    }\n  });\n}, 'phone');"}},{"configs":{"itemId":"search","emptyText":"请输入手机号"},"expanded":false,"children":[],"type":"text"},{"configs":{"itemId":"button1","text":"查询","iconCls":"search_icon"},"expanded":false,"children":[],"type":"button","events":{"click":"app.store.load({\n\tparams: {\n\t\t'phone': app.search.getValue()\n    }\n});"}}],"type":"toolbar"},{"configs":{"itemId":"columns"},"expanded":true,"children":[{"configs":{"itemId":"column1","xtype":"rownumberer","width":"60","text":"No."},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"column2","dataIndex":"phone","text":"手机号"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"column3","dataIndex":"salt","text":"密钥"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"column4","dataIndex":"login_at","width":"150","text":"最后登录"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"column5","dataIndex":"login_count","text":"登录次数"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"column6","dataIndex":"reg_at","text":"注册时间"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"column7","dataIndex":"id","text":"ID"},"expanded":false,"children":[],"type":"column"}],"type":"array"},{"configs":{"itemId":"store","autoLoad":"true","url":"builder?xwl=user/crud/list"},"expanded":false,"children":[],"type":"store"}],"type":"grid"},{"configs":{"itemId":"winUser","dialog":"true","editWin":"true","width":"350","title":"新增用户","height":"180"},"expanded":true,"children":[{"configs":{"itemId":"formUser","layoutType":"vboxForm"},"expanded":true,"children":[{"configs":{"itemId":"phone","allowBlank":"false","fieldLabel":"手机号","blankText":"请输入手机号"},"expanded":false,"children":[],"type":"text"},{"configs":{"itemId":"salt","allowBlank":"false","fieldLabel":"密钥","blankText":"请输入密钥"},"expanded":false,"children":[],"type":"text"}],"type":"form"}],"type":"window","events":{"ok":"var values;\nif(app.isNew) {\n  values = Wb.getValue(app.winUser);\n  Wb.request({\n\turl: 'builder?xwl=user/crud/insert',\n    params: values,\n    success: function(resp) {\n\t\t//Wb.apply(values, Wb.decode(resp.responseText)); //把后台返回的ID_FIELD等数据应用到values中\n        //Wb.add(app.grid1, values); //同步在客户端表格中添加\n        win.close();\n\t\tapp.store.reload();\n    }\n  });\n}else{\n  values = Wb.applyIf(Wb.getValue(win), Wb.getData(app.selRec, true));\n  Wb.request({\n\turl: 'builder?xwl=user/crud/update',\n    params: values,\n    success: function(resp) {\n\t\tWb.update(app.selRec, values);\n\t\twin.close();\n    }\n  });\n}"}}],"type":"viewport"}],"type":"module"}],"roles":{"default":1},"title":"用户管理","iconCls":"","inframe":false,"pageLink":""}